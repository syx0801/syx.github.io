<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    
    <title>codeforces #574 Div2 D2 | å¯èƒ½æ˜¯è½©è½©å­</title>
    <meta name="renderer" content="webkit">
    <meta name="HandheldFriendly" content="True">
    <meta name="MobileOptimized" content="320">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

    <meta name="description" content="çˆ†é›¶ä¸‡å²~\(â‰§â–½â‰¦)/~">

    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="codeforces #574 Div2 D2 | å¯èƒ½æ˜¯è½©è½©å­">
    <meta name="twitter:description" content="çˆ†é›¶ä¸‡å²~\(â‰§â–½â‰¦)/~">

    <meta property="og:type" content="article">
    <meta property="og:title" content="codeforces #574 Div2 D2 | å¯èƒ½æ˜¯è½©è½©å­">
    <meta property="og:description" content="çˆ†é›¶ä¸‡å²~\(â‰§â–½â‰¦)/~">

    
    <meta name="author" content="å¯èƒ½æ˜¯è½©è½©å­">
    
    <link rel="stylesheet" href="/css/vno.css">
    <link rel="stylesheet" href="//netdna.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css">

    
    <link rel="icon" href="/images/avatar-small.png">
    

    <meta name="generator" content="hexo"/>
    
    <link rel="alternate" type="application/rss+xml" title="å¯èƒ½æ˜¯è½©è½©å­" href="/atom.xml">
    

    <link rel="canonical" href="syx0801.github.io/2019/07/23/codeforces-574-Div2-D2/"/>

                 
</head>

<body class="home-template no-js">
    <script src="//cdn.bootcss.com/jquery/2.1.4/jquery.min.js"></script>
    <script src="/js/main.js"></script>
    <span class="mobile btn-mobile-menu">
        <i class="fa fa-list btn-mobile-menu__icon"></i>
        <i class="fa fa-angle-up btn-mobile-close__icon hidden"></i>
    </span>

    
<header class="panel-cover panel-cover--collapsed" style="background-image: url(/images/background-cover.jpg)">
  <div class="panel-main">
    <div class="panel-main__inner panel-inverted">
    <div class="panel-main__content">

        <a href="/" title="å‰å¾€ å¯èƒ½æ˜¯è½©è½©å­ çš„ä¸»é¡µ"><img src="/images/avatar.jpg" width="80" alt="å¯èƒ½æ˜¯è½©è½©å­ logo" class="panel-cover__logo logo" /></a>
        <h1 class="panel-cover__title panel-title"><a href="/" title="link to homepage for å¯èƒ½æ˜¯è½©è½©å­">å¯èƒ½æ˜¯è½©è½©å­</a></h1>
        
        <span class="panel-cover__subtitle panel-subtitle">ä»å‰æœ‰åº§å±±ï¼Œå±±é‡Œæœ‰ä¸ªåº™ï¼Œåº™é‡Œæœ‰ä¸ªå°å’Œå°šåœ¨æ‹¼å‘½å†™ç¨‹åºï¼Œä»å‰æœ‰åº§å±±ï¼Œå±±é‡Œæœ‰ä¸ªåº™ï¼Œåº™é‡Œæœ‰ä¸ªè€å’Œå°šæ‹¼å‘½debugã€‚</span>
        
        <hr class="panel-cover__divider" />
        <p class="panel-cover__description">é€‰é”™é“è·¯å°±èµ°ä¸åˆ°æƒ³å»çš„åœ°æ–¹äº†ã€‚</p>
        <hr class="panel-cover__divider panel-cover__divider--secondary" />

        <div class="navigation-wrapper">
          <div>
          <nav class="cover-navigation cover-navigation--primary">
            <ul class="navigation">
              <li class="navigation__item"><a href="/#blog" title="è®¿é—®åšå®¢" class="blog-button">åšå®¢</a></li>
            
              <li class="navigation__item"><a href="/about">å…³äº</a></li>
            
              <li class="navigation__item"><a href="/friendlinks">å‹é“¾</a></li>
            
            </ul>
          </nav>
          </div>
          <div>
          <nav class="cover-navigation navigation--social">
  <ul class="navigation">

  <!-- Weibo-->
  
  <li class="navigation__item">
    <a href="http://weibo.com/6177197124/profile?topnav=1&amp;wvr=6&amp;is_all=1" title="æˆ‘çš„å¾®åš" target="_blank">
      <i class='social fa fa-weibo'></i>
      <span class="label">Weibo</span>
    </a>
  </li> 


  <!-- Github -->
  
  <li class="navigation__item">
    <a href="https://github.com/monniya" title="æŸ¥çœ‹æˆ‘çš„GitHubä¸»é¡µ" target="_blank">
      <i class='social fa fa-github'></i>
      <span class="label">Github</span>
    </a>
  </li>


<!-- Stack Overflow -->
        

  <!-- Google Plus -->
  

<!-- Facebook -->

  
<!-- Twitter -->

  <li class="navigation__item">
    <a href="https://twitter.com/onlymonniya" title="ä¸ŠTwitteræ‰¾æˆ‘" target="_blank">
      <i class='social fa fa-twitter'></i>
      <span class="label">Twitter</span>
    </a>
  </li>

  

  <li class="navigation__item">
    <a href="/atom.xml" title="RSS" target="_blank">
      <i class='social fa fa-rss'></i>
      <span class="label">RSS</span>
    </a>
  </li>



  </ul>
</nav>

          </div>
        </div>

      </div>

    </div>

    <div class="panel-cover--overlay cover-purple"></div>
  </div> 
</header>

    <div class="content-wrapper">
        <div class="content-wrapper__inner">
            <article class="post-container post-container--single">

  <header class="post-header">
    <div class="post-meta">
      <time datetime="2019-07-23T04:54:36.000Z" class="post-list__meta--date date">2019-07-23</time> &#8226; <span class="post-meta__tags tags">äº&nbsp;
  <a class="tag-link" href="/tags/æ€ç»´ï¼Œæ¨å¯¼/">æ€ç»´ï¼Œæ¨å¯¼</a>
 </span>
      <span class="page-pv">
      &nbsp;é˜…è¯»&nbsp;<span id="busuanzi_value_page_pv"><i class="fa fa-spinner fa-spin"></i></span>
      </span> 
   
    </div>
    <h1 class="post-title">codeforces #574 Div2 D2</h1>
  </header>

  <section class="post">
    <h2 id="ä¼ é€é—¨"><a href="#ä¼ é€é—¨" class="headerlink" title="ä¼ é€é—¨"></a><a href="http://codeforces.com/contest/1195/problem/D2" target="_blank" rel="external">ä¼ é€é—¨</a></h2><h3 id="é¢˜ç›®èƒŒæ™¯"><a href="#é¢˜ç›®èƒŒæ™¯" class="headerlink" title="é¢˜ç›®èƒŒæ™¯"></a>é¢˜ç›®èƒŒæ™¯</h3><blockquote>
<p> This problem differs from the previous one only in the absence of the constraint on the equal length of all numbers ğ‘1,ğ‘2,â€¦,ğ‘ğ‘›a1,a2,â€¦,an.*</p>
<p>A team of SIS students is going to make a trip on a submarine. Their target is an ancient treasure in a sunken ship lying on the bottom of the Great Rybinsk sea. Unfortunately, the students donâ€™t know the coordinates of the ship, so they asked Meshanya (who is a hereditary mage) to help them. He agreed to help them, but only if they solve his problem. </p>
<p>Letâ€™s denote a function that alternates digits of two numbers ğ‘“(ğ‘1ğ‘2â€¦ğ‘ğ‘âˆ’1ğ‘ğ‘,ğ‘1ğ‘2â€¦ğ‘ğ‘âˆ’1ğ‘ğ‘)f(a1a2â€¦apâˆ’1ap,b1b2â€¦bqâˆ’1bq), where ğ‘1â€¦ğ‘ğ‘a1â€¦ap and ğ‘1â€¦ğ‘ğ‘b1â€¦bq are digits of two integers written in the decimal notation without leading zeros.</p>
<p>In other words, the function ğ‘“(ğ‘¥,ğ‘¦)f(x,y) alternately shuffles the digits of the numbers ğ‘¥x and ğ‘¦y by writing them from the lowest digits to the older ones, starting with the number ğ‘¦y. The result of the function is also built from right to left (that is, from the lower digits to the older ones). If the digits of one of the arguments have ended, then the remaining digits of the other argument are written out. Familiarize with examples and formal definitions of the function below.</p>
<p>For example:<br>ğ‘“(1111,2222)=12121212    f(1111,2222)=12121212    ğ‘“(7777,888)=7787878    f(7777,888)=7787878    ğ‘“(33,44444)=4443434    f(33,44444)=4443434    ğ‘“(555,6)=5556f(555,6)=5556    ğ‘“(111,2222)=2121212</p>
<p>Formally,</p>
<ul>
<li>if ğ‘â‰¥ğ‘pâ‰¥q then ğ‘“(ğ‘1â€¦ğ‘ğ‘,ğ‘1â€¦ğ‘ğ‘)=ğ‘1ğ‘2â€¦ğ‘ğ‘âˆ’ğ‘+1ğ‘1ğ‘ğ‘âˆ’ğ‘+2ğ‘2â€¦ğ‘ğ‘âˆ’1ğ‘ğ‘âˆ’1ğ‘ğ‘ğ‘ğ‘f(a1â€¦ap,b1â€¦bq)=a1a2â€¦apâˆ’q+1b1apâˆ’q+2b2â€¦apâˆ’1bqâˆ’1apbq;</li>
<li>if ğ‘&lt;ğ‘p&lt;q then ğ‘“(ğ‘1â€¦ğ‘ğ‘,ğ‘1â€¦ğ‘ğ‘)=ğ‘1ğ‘2â€¦ğ‘ğ‘âˆ’ğ‘ğ‘1ğ‘ğ‘âˆ’ğ‘+1ğ‘2â€¦ğ‘ğ‘âˆ’1ğ‘ğ‘âˆ’1ğ‘ğ‘ğ‘ğ‘f(a1â€¦ap,b1â€¦bq)=b1b2â€¦bqâˆ’pa1bqâˆ’p+1a2â€¦apâˆ’1bqâˆ’1apbq.</li>
</ul>
<p>Mishanya gives you an array consisting of ğ‘›n integers ğ‘ğ‘–ai, your task is to help students to calculate âˆ‘ğ‘›ğ‘–=1âˆ‘ğ‘›ğ‘—=1ğ‘“(ğ‘ğ‘–,ğ‘ğ‘—)âˆ‘i=1nâˆ‘j=1nf(ai,aj) modulo 998244353998244353.</p>
</blockquote>
<hr>
<h3 id="Input"><a href="#Input" class="headerlink" title="Input"></a><strong>Input</strong></h3><blockquote>
<p>The first line of the input contains a single integer ğ‘›n (1â‰¤ğ‘›â‰¤1000001â‰¤nâ‰¤100000) â€” the number of elements in the array. The second line of the input contains ğ‘›n integers ğ‘1,ğ‘2,â€¦,ğ‘ğ‘›a1,a2,â€¦,an (1â‰¤ğ‘ğ‘–â‰¤1091â‰¤aiâ‰¤109) â€” the elements of the array.</p>
</blockquote>
<hr>
<h3 id="Output"><a href="#Output" class="headerlink" title="Output"></a><strong>Output</strong></h3><blockquote>
<p>Print the answer modulo 998244353998244353.</p>
</blockquote>
<hr>
<h3 id="è§£é¢˜æ€è·¯"><a href="#è§£é¢˜æ€è·¯" class="headerlink" title="è§£é¢˜æ€è·¯"></a><strong>è§£é¢˜æ€è·¯</strong></h3><blockquote>
<p>æŠŠæ•°å­—éƒ½ç»„åˆèµ·æ¥æ±‚ä»–ä»¬çš„å€¼ã€‚</p>
<p>æˆ‘ä»¬å‘ç° 12 3 å°±æ˜¯ 222+33</p>
<p>ä¹Ÿå°±æ˜¯è¯´ï¼Œè‹¥12 è¿™ä¸ª2çš„ä½ç½® å°äºç­‰äº3çš„ä½æ•°ï¼Œé‚£å°±å˜æˆ 22</p>
<p>1è¿™ä¸ªä½ç½®å¤§äº3çš„ä½ç½®ï¼Œé‚£å°±å˜æˆ 200</p>
<p>æ‰€ä»¥æˆ‘ä»¬ç»Ÿè®¡ä¸€ä¸‹æ‰€æœ‰æ•°çš„ä½æ•°ï¼Œæšä¸¾æ¯ä¸ªæ•°å­—ï¼Œå†æšä¸¾æ‰€æœ‰æ•°çš„ä½æ•°ã€‚</p>
<p>æ ¹æ®æ¨å¯¼å‡ºçš„ç»“è®ºï¼Œ</p>
<p>if(æšä¸¾çš„ä½æ•°j &gt;= å½“å‰æ•°å­—çš„ç¬¬posä½æ•°å­—)</p>
<p>â€‹    ans+=c$<em>$cnt[j]$</em>$p10[pos$<em>$2], ans+=c$</em>$cnt[j]$<em>$p10[pos$</em>$2-1];</p>
<p>else ans+=2$<em>$c$</em>$cnt[j]$*$p10[pos+j];</p>
</blockquote>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;set&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LL long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> close ios::sync_with_stdio(false);</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> FOR(a,b,i) for(int i=a;i&lt;=b;i++)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> FOR2(a,b,i) for(int i=a;i&lt;b;i++)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> debug(x) cout &lt;&lt; <span class="string">"debug:"</span> &lt;&lt; x &lt;&lt; endl;</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MOD = <span class="number">998244353</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> range = <span class="number">1000005</span>;</span><br><span class="line">Â </span><br><span class="line"><span class="keyword">int</span> n,cnt[<span class="number">20</span>];</span><br><span class="line">LL a[range],pw[<span class="number">30</span>],ans;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">cal</span><span class="params">(LL x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> len = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(x)&#123;</span><br><span class="line">        x/=<span class="number">10</span>;</span><br><span class="line">        len++;</span><br><span class="line">    &#125;</span><br><span class="line">    cnt[len]++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span>&#123;</span><br><span class="line">    pw[<span class="number">1</span>]=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">2</span>;i &lt; <span class="number">30</span>;i++)</span><br><span class="line">        pw[i] = (pw[i<span class="number">-1</span>]*<span class="number">10</span>)%MOD;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    close;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n;</span><br><span class="line">    init();</span><br><span class="line">    FOR(<span class="number">1</span>,n,i)&#123;</span><br><span class="line">        <span class="built_in">cin</span> &gt;&gt; a[i];</span><br><span class="line">        cal(a[i]);</span><br><span class="line"><span class="comment">//        debug(cnt[i]);</span></span><br><span class="line">    &#125;</span><br><span class="line">    FOR(<span class="number">1</span>,n,i)&#123;</span><br><span class="line">        LL x = a[i];</span><br><span class="line">        <span class="keyword">int</span> pos = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span>(x)&#123;</span><br><span class="line">            LL c = x%<span class="number">10</span>;</span><br><span class="line">            x /= <span class="number">10</span>;</span><br><span class="line">            pos++;</span><br><span class="line"><span class="comment">//            debug(pos);</span></span><br><span class="line">            FOR(<span class="number">1</span>,<span class="number">10</span>,j)&#123;</span><br><span class="line">                <span class="keyword">if</span>(j &gt;= pos)&#123;</span><br><span class="line">                    ans = (ans+(c*cnt[j]*pw[pos*<span class="number">2</span>])%MOD)%MOD;</span><br><span class="line">                    ans = (ans+(c*cnt[j]*pw[pos*<span class="number">2</span><span class="number">-1</span>])%MOD)%MOD;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                    ans = (ans+(<span class="number">2</span>*c*cnt[j]*pw[pos+j])%MOD)%MOD;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; ans &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<hr>
<p><img src="http://i2.tiimg.com/597109/265411de14263d92.jpg" alt="å˜¤å˜¤å˜¤"></p>

  </section>

</article>

<section class="read-more">
           
    
        
        
               
            <div class="read-more-item">
                <span class="read-more-item-dim">æ›´æ—©çš„æ–‡ç« </span>
                <h2 class="post-list__post-title post-title"><a href="/2019/07/22/2019CSU-ACMæš‘å‡é›†è®­çƒ­èº«èµ›/" title="2019CSU_ACMæš‘å‡é›†è®­çƒ­èº«èµ› B">2019CSU_ACMæš‘å‡é›†è®­çƒ­èº«èµ› B</a></h2>
                <p class="excerpt">
                
                ä¼ é€é—¨é¢˜ç›®æè¿°
Polycarp is a head of a circus troupe. There are n â€” an even number â€” artists in the troupe. It is known whether the i-th artist can perform a
                &hellip;
                </p>
                <div class="post-list__meta"><time datetime="2019-07-22T06:50:21.000Z" class="post-list__meta--date date">2019-07-22</time> &#8226; <span class="post-list__meta--tags tags">äº&nbsp;
  <a class="tag-link" href="/tags/æ•°å­¦ï¼Œæ€ç»´/">æ•°å­¦ï¼Œæ€ç»´</a>
</span><a class="btn-border-small" href="/2019/07/22/2019CSU-ACMæš‘å‡é›†è®­çƒ­èº«èµ›/">ç»§ç»­é˜…è¯»</a></div>
                       
            </div>
        
     
   
   
  
</section>

  

            <footer class="footer">
    <span class="footer__copyright">
        æœ¬ç«™ç‚¹é‡‡ç”¨ <a href="http://creativecommons.org/licenses/by-nc-sa/4.0/">çŸ¥è¯†å…±äº«ç½²å-éå•†ä¸šæ€§ä½¿ç”¨-ç›¸åŒæ–¹å¼å…±äº« 4.0 å›½é™…è®¸å¯åè®®</a>
    </span>
    <span class="footer__copyright">
        åŸºäº <a href="http://hexo.io">Hexo</a> æ­å»ºï¼Œæ„Ÿè°¢ <a href="https://pages.github.com/">GitHub Pages</a> æä¾›å…è´¹çš„æ‰˜ç®¡æœåŠ¡
    </span>
    <span class="footer__copyright">
        &copy; 2019 - æœ¬ç«™ä½¿ç”¨ <a href="https://github.com/monniya/hexo-theme-new-vno ">new-vno</a> ä¸»é¢˜,
        ç”±<a href="https://monniya.com ">@Monniya</a> ä¿®æ”¹è‡ª <a href="https://github.com/lenbo-ma/hexo-theme-vno" target="_blank">Vno</a>, åŸåˆ›å‡ºè‡ª<a href="http://github.com/onevcat/vno" target="_blank">onevcat</a>
    </span>
    
</footer>


        </div>
    </div>

     
    


    <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>

    
  
    <script type="text/javascript" src="/live2d/script.js"></script>
    <canvas id="live2dcanvas" width="150" height="300" class="live2d"></canvas>
    <style>
      #live2dcanvas {
        position: fixed;
        right: 0px;
        z-index: 999;
        pointer-events: none;
        bottom: -60px;
      }
    </style>
    <script>loadlive2d("live2dcanvas" ,"/live2d/assets/koharu/koharu.model.json")</script>
  
</body>
</html>
<!-- é¡µé¢ç‚¹å‡»å°çº¢å¿ƒ -->
<script type="text/javascript" src="/js/src/love.js"></script>